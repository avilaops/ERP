# AvilaDB Configuration File
# Todas as configura√ß√µes s√£o opcionais. Defaults s√£o usados se omitidos.

[server]
# Endere√ßo e porta para bind do servidor
# Default: "127.0.0.1:7000"
bind_addr = "127.0.0.1:7000"

# Diret√≥rio para armazenar dados persistentes
# Default: "./aviladb-data"
data_dir = "./aviladb-data"

# M√°ximo de threads de trabalho
# Default: n√∫mero de CPUs dispon√≠veis
# üöÄ YOLO MODE: Maximum threads
worker_threads = 32

# Modo de opera√ß√£o
# Valores: "standalone" | "cluster"
# Default: "standalone"
mode = "standalone"


[performance]
# Tamanho do cache em mem√≥ria (MB)
# Usado para armazenar dados frequentemente acessados
# Default: 256
# üöÄ YOLO MODE: Maximum cache!
cache_size_mb = 8192

# Intervalo para checkpoint/flush em disco (segundos)
# Default: 60
# üöÄ YOLO MODE: Less frequent checkpoints
checkpoint_interval_sec = 300

# N√∫mero de threads para compacta√ß√£o de LSM Tree
# Default: 2
# üöÄ YOLO MODE: More threads!
compaction_threads = 8

# Tamanho do MemTable antes de flush (MB)
# Default: 64
# üöÄ YOLO MODE: Bigger MemTable!
memtable_size_mb = 256

# N√∫mero m√°ximo de n√≠veis no LSM Tree
# Default: 7
lsm_max_levels = 7

# Fator de crescimento entre n√≠veis
# Default: 10 (cada n√≠vel √© 10x maior que o anterior)
level_size_multiplier = 10


[crypto]
# Chave p√∫blica do servidor (hex)
# Gerada automaticamente se n√£o fornecida
# Exemplo: "02a1b2c3d4e5f6789..."
# public_key = ""

# Chave privada do servidor (hex)
# ‚ö†Ô∏è  NUNCA commite isso em controle de vers√£o!
# ‚ö†Ô∏è  Use vari√°veis de ambiente em produ√ß√£o: AVILADB_PRIVATE_KEY
# private_key = ""

# Algoritmo de assinatura
# Valores: "schnorr" | "ecdsa"
# Default: "schnorr" (mais eficiente)
signature_scheme = "schnorr"

# For√ßa verifica√ß√£o de assinatura em todas as transa√ß√µes
# Default: true
enforce_signatures = true


[network]
# M√°ximo de conex√µes simult√¢neas
# Default: 1000
max_connections = 1000

# Timeout de idle para conex√µes (segundos)
# Conex√µes inativas s√£o fechadas ap√≥s esse per√≠odo
# Default: 30
idle_timeout_sec = 30

# Tamanho m√°ximo de payload UDP (bytes)
# QUIC usa UDP, ent√£o deve ser <= MTU da rede
# Default: 1200 (seguro para maioria das redes)
# üöÄ YOLO MODE: Maximum UDP!
max_udp_payload = 1500

# N√∫mero de streams QUIC concorrentes por conex√£o
# Default: 100
# üöÄ YOLO MODE: 5x more streams!
max_concurrent_streams = 500

# Tamanho inicial da janela de congestionamento (bytes)
# Default: 14720 (10 * max_udp_payload)
initial_congestion_window = 14720

# Ativa 0-RTT reconnection
# Melhora lat√™ncia mas tem riscos de replay attack
# Default: true
enable_zero_rtt = true

# Keep-alive ping interval (segundos)
# 0 = desabilitado
# Default: 10
keep_alive_interval = 10


[transaction]
# N√≠vel de isolamento padr√£o
# Valores: "read_uncommitted" | "read_committed" | "repeatable_read" | "serializable"
# Default: "repeatable_read" (via MVCC)
default_isolation = "repeatable_read"

# Timeout m√°ximo para transa√ß√£o (segundos)
# Transa√ß√µes que excedem esse tempo s√£o abortadas
# Default: 60
max_transaction_duration_sec = 60

# N√∫mero m√°ximo de vers√µes a manter (MVCC)
# Default: 100
max_versions_per_key = 100

# Intervalo de garbage collection de vers√µes antigas (segundos)
# Default: 300 (5 minutos)
gc_interval_sec = 300


[storage]
# Engine de storage
# Valores: "lsm_tree" (√∫nico suportado por enquanto)
# Default: "lsm_tree"
engine = "lsm_tree"

# Compress√£o de dados em disco
# Valores: "none" | "lz4" | "zstd"
# Default: "none" (compress√£o vem em v0.2)
compression = "none"

# Sync fsync ap√≥s cada write
# true = durabilidade m√°xima mas mais lento
# false = mais r√°pido mas risco de perda em crash
# Default: true
# üöÄ YOLO MODE: ‚ö†Ô∏è DANGEROUS! No fsync = risk of data loss!
fsync_on_write = false

# Usa direct I/O (bypass page cache do SO)
# Reduz lat√™ncia mas requer hardware adequado
# Default: false
# üöÄ YOLO MODE: Direct I/O activated!
use_direct_io = true


[logging]
# N√≠vel de log
# Valores: "trace" | "debug" | "info" | "warn" | "error"
# Default: "info"
level = "info"

# Formato de log
# Valores: "json" | "text"
# Default: "text"
format = "text"

# Arquivo para escrever logs
# Default: stdout
# log_file = "./aviladb.log"

# Rota√ß√£o de logs
# Default: false
# rotate_logs = true
# max_log_size_mb = 100
# max_log_files = 10


[monitoring]
# Porta para m√©tricas (Prometheus-compatible)
# 0 = desabilitado
# Default: 0 (desabilitado)
metrics_port = 9090

# Intervalo de coleta de m√©tricas (segundos)
# Default: 10
metrics_interval_sec = 10

# Ativa profiling cont√≠nuo
# ‚ö†Ô∏è  Impacto em performance, apenas para desenvolvimento
# Default: false
enable_profiling = false


[cluster]
# Configura√ß√µes de cluster (futuro)
# Por enquanto apenas modo standalone √© suportado

# Node ID √∫nico no cluster
# node_id = "node-1"

# Lista de peers
# peers = [
#     "127.0.0.1:7001",
#     "127.0.0.1:7002",
# ]

# Fator de replica√ß√£o
# replication_factor = 3

# Algoritmo de consenso
# Valores: "raft"
# consensus = "raft"


[experimental]
# Features experimentais - use com cuidado!

# Ativa GLV endomorphism para secp256k1 (2x mais r√°pido)
# Default: false (ainda n√£o implementado)
use_glv_endomorphism = false

# Ativa Shamir Secret Sharing para chaves
# Default: false (futuro)
use_threshold_signatures = false

# Usa AVX-512 se dispon√≠vel
# Default: true
# üöÄ YOLO MODE: All CPU optimizations!
use_avx512 = true

# Usa huge pages (requer configura√ß√£o do SO)
# Default: false
# üöÄ YOLO MODE: Huge pages for memory!
use_huge_pages = true


# ========================================
# Exemplos de Configura√ß√£o por Ambiente
# ========================================

# --- Development ---
# [server]
# bind_addr = "127.0.0.1:7000"
# data_dir = "./dev-data"
#
# [logging]
# level = "debug"
#
# [monitoring]
# metrics_port = 9090
# enable_profiling = true


# --- Production ---
# [server]
# bind_addr = "0.0.0.0:7000"
# data_dir = "/var/lib/aviladb"
# worker_threads = 16
#
# [performance]
# cache_size_mb = 2048
# compaction_threads = 4
#
# [network]
# max_connections = 10000
#
# [storage]
# fsync_on_write = true
# use_direct_io = true
#
# [logging]
# level = "warn"
# format = "json"
# log_file = "/var/log/aviladb/aviladb.log"
# rotate_logs = true


# --- High Performance ---
# [server]
# worker_threads = 32
#
# [performance]
# cache_size_mb = 8192
# memtable_size_mb = 256
# checkpoint_interval_sec = 300
#
# [network]
# max_udp_payload = 1500
# enable_zero_rtt = true
#
# [storage]
# fsync_on_write = false  # ‚ö†Ô∏è  Risco de perda de dados!
# use_direct_io = true
#
# [experimental]
# use_avx512 = true
# use_huge_pages = true
